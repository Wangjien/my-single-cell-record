{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome to Single Cell Omics Docs","text":"<p>This is a comprehensive documentation site for single cell omics analysis, covering core technologies (scRNA-seq, scATAC-seq, etc.), analysis workflows, and practical tutorials.</p> <p>For more professional single cell analysis resources, visit:</p> <ul> <li>Single Cell Portal (Broad Institute)</li> <li>Scanpy Official Docs</li> <li>Seurat Official Docs</li> </ul> <p></p>"},{"location":"scRNA-seq/","title":"scRNA-seq","text":""},{"location":"scRNA-seq/#10x-cellranger","title":"10X \u5206\u6790\u5de5\u5177CellRanger\u5b66\u4e60","text":""},{"location":"scRNA-seq/#1-cellranger-count","title":"1. cellranger count","text":"<p>\u5b98\u65b9\u6559\u7a0b\uff1ahttps://www.10xgenomics.com/support/software/cell-ranger/latest/tutorials/cr-tutorial-ct</p> <p><code>cellranger count</code> \u662f 10x Genomics \u5b98\u65b9\u7528\u4e8e\u5355\u7ec6\u80de RNA-seq\uff08scRNA-seq\uff09\u6570\u636e\u5b9a\u91cf\u5206\u6790\u7684\u6838\u5fc3\u547d\u4ee4\uff0c\u4e3b\u8981\u529f\u80fd\u662f\u5c06\u5355\u7ec6\u80de\u6d4b\u5e8f\u7684\u539f\u59cb fastq \u6587\u4ef6\u4e0e\u53c2\u8003\u57fa\u56e0\u7ec4\u6bd4\u5bf9\uff0c\u751f\u6210\u7ec6\u80de\u7ea7\u522b\u7684\u57fa\u56e0\u8868\u8fbe\u77e9\u9635\u3002</p>"},{"location":"scRNA-seq/#11-cellranger-count","title":"1.1 cellranger count\u4e0b\u8f7d\u548c\u5b89\u88c5","text":"<p>\u76ee\u524d\u7684cellranger\u7248\u672c\u5df2\u7ecf\u66f4\u65b0\u5230\u4e86Cell Ranger 10.0.0 (Nov 13, 2025)\uff0c\u5982\u679c\u9700\u8981\u4e0b\u8f7d\u5386\u53f2\u7248\u672c\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95eehttps://www.10xgenomics.com/support/software/cell-ranger/downloads/previous-versions\u8fdb\u884c\u4e0b\u8f7d\u3002\u53c2\u8003\u6570\u636e\u6574\u4f53\u6bd4\u8f83\u5927\uff0c\u5982\u679c\u670d\u52a1\u5668\u4e0b\u8f7d\u901f\u5ea6\u8fc7\u6162\uff0c\u4e5f\u53ef\u4ee5\u672c\u5730\u4e0b\u8f7d\uff0c\u5e76\u4e0a\u4f20\u81f3\u670d\u52a1\u5668\u3002</p>"},{"location":"scRNA-seq/#12-cell-ranger-v700-v1000","title":"1.2 Cell Ranger \u5404\u7248\u672c\u6838\u5fc3\u53d8\u5316\u5bf9\u6bd4\u8868\uff08v7.0.0 \u81f3 v10.0.0\uff09","text":"\u7248\u672c \u53d1\u5e03\u65f6\u95f4 \u6838\u5fc3\u529f\u80fd/\u4f18\u5316 \u517c\u5bb9\u6027/\u652f\u6301\u8981\u6c42 v10.0.0 2025-05 1. \u65b0\u589e\u201c\u591a\u7ec4\u5b66\u8054\u5408\u805a\u7c7b\u201d\u529f\u80fd\uff0c\u6574\u5408\u57fa\u56e0\u8868\u8fbe\u3001ATAC\u3001\u86cb\u767d\u6570\u636e\u8054\u5408\u5206\u67902. \u652f\u6301Gem-X Ultra\u82af\u7247\u53ca8-plex\u9ad8 multiplexing \u6587\u5e933. \u4f18\u5316CRISPR\u7b5b\u9009\u5bcc\u96c6\u5206\u6790\uff0c\u63d0\u5347\u57fa\u56e0\u6548\u5e94\u91cf\u5316\u7cbe\u5ea64. UMAP\u964d\u7ef4\u901f\u5ea6\u8f83v9\u63d0\u534740%\uff0c\u5927\u6837\u672c\u5206\u6790\u6548\u7387\u663e\u8457\u63d0\u53475. web summary\u65b0\u589e\u201c\u591a\u7ec4\u5b66\u5173\u8054\u89c6\u56fe\u201d 1. \u652f\u63012025-A\u7248\u53c2\u8003\u57fa\u56e0\u7ec4\uff08GRCh38/GRCm39\u6ce8\u91ca\u66f4\u65b0\uff092. \u517c\u5bb9PTG\u6297\u4f53v2\u7248\u86cb\u767d\u6587\u5e933. \u7cfb\u7edf\u8981\u6c42\uff1aPython 3.11+\uff0cCPU\u652f\u6301AVX2\uff0c\u5185\u5b58\u226564GB\uff08100k\u7ec6\u80de\uff094. \u517c\u5bb9Illumina NovaSeq X Plus\u6700\u65b0\u6570\u636e v9.0.0 2024-11 1. \u652f\u6301Gem-X Universal\u82af\u7247OCM\u6280\u672f\uff0c\u9002\u914d4-plex 3' v4/5' v3\u6587\u5e932. \u65b0\u589e<code>cell ranger annotate</code>\u547d\u4ee4\uff0c\u5b9e\u73b0\u81ea\u52a8\u5316\u7ec6\u80de\u7c7b\u578b\u6ce8\u91ca3. aggr\u6d41\u7a0b\u9ed8\u8ba4\u964d\u7ef4\u6539\u4e3aUMAP\uff0c\u901f\u5ea6\u63d0\u53472.5\u500d4. \u5185\u7f6eClonotype\u5206\u7ec4\u529f\u80fd\uff0c\u7b80\u5316\u514d\u75ab\u7ec4\u5e93\u5206\u67905. \u4f18\u5316VDJ\u6587\u5e93\u6bd4\u5bf9\u903b\u8f91\uff0c\u63d0\u5347TCRBCR\u7ec4\u88c5\u51c6\u786e\u6027 1. \u652f\u63012024-A\u7248\u53c2\u8003\u57fa\u56e0\u7ec42. \u7cfb\u7edf\u8981\u6c42\uff1aCPU\u652f\u6301AVX\uff0cPython 3.10+3. \u517c\u5bb93' v4\u30015' v3\u3001VDJ v2\u7b49\u6587\u5e934. \u652f\u6301CentOS 8\u3001Ubuntu 20.04/22.04 v8.0.0 2024-03 1. \u9996\u6b21\u652f\u6301Gem-X\u7cfb\u52173' v4\u548c5' v3\u6587\u5e93\uff0c\u4f4e\u4e30\u5ea6\u57fa\u56e0\u68c0\u51fa\u7387\u63d0\u534715%2. \u65b0\u589e<code>min-crispr-umi</code>\u53c2\u6570\uff0c\u81ea\u5b9a\u4e49CRISPR guide\u8ba1\u6570\u9608\u503c3. \u4f18\u5316HT\u6587\u5e93EmptyDrops\u8fc7\u6ee4\uff0c\u63d0\u5347\u9ad8\u7ec6\u80de\u91cf\u6837\u672c\u68c0\u51fa\u51c6\u786e\u60274. \u86cb\u767d\u5206\u6790\u65b0\u589e\u201c\u6297\u4f53\u6279\u6b21\u6821\u6b63\u201d\u9009\u9879 1. \u652f\u6301PTG\u6297\u4f53\u86cb\u767d\u8868\u8fbe\u6587\u5e93\u5206\u67902. \u5b9e\u9a8c\u6027\u652f\u6301\u56fa\u5b9aRNA\u6837\u672cCRISPR\u6587\u5e93\u5206\u67903. \u7cfb\u7edf\u8981\u6c42\uff1aPython 3.9+\uff0c\u5185\u5b58\u226532GB\uff0830k\u7ec6\u80de\uff094. \u517c\u5bb9NextSeq 20005500\u6570\u636e v8.0.1 2024-05 1. \u4fee\u590d<code>--force-cells</code>\u53c2\u6570\u5339\u914d\u65f6\u62a5\u9519\u95ee\u98982. \u8c03\u6574HT\u6587\u5e93EmptyDrops\u80cc\u666f\u8303\u56f4\u81f380k-160k\uff0c\u9700\u624b\u52a8\u6307\u5b9a\u6587\u5e93\u7c7b\u578b3. \u4fee\u590d\u53c2\u8003\u57fa\u56e0\u7ec4\u65e0\u8f6c\u5f55\u672c\u6ce8\u91ca\u5bfc\u81f4\u7684\u77e9\u9635\u9519\u8bef4. \u4f18\u5316web summary\u5206\u7fa4\u56fe\u8868\u6e32\u67d3\u901f\u5ea6 1. \u5b8c\u5584HT\u6587\u5e93\u517c\u5bb9\u6027\uff0c\u9700\u6307\u5b9a<code>--chemistry=chromium-ht-v3</code>\u7b49\u53c2\u65702. \u4fee\u590d\u81ea\u5b9a\u4e49\u53c2\u8003\u57fa\u56e0\u7ec4\u517c\u5bb9\u6027\u95ee\u98983. \u7ee7\u627fv8.0.0\u7cfb\u7edf\u8981\u6c42\u548c\u6587\u5e93\u652f\u6301\u8303\u56f4 v7.2.0 2023-10 1. \u65b0\u589e\u201c\u6297\u4f53\u80cc\u666f\u6821\u6b63\u201d\u529f\u80fd\uff0c\u4f18\u5316\u86cb\u767d\u5b9a\u91cf\u7ed3\u679c2. ATAC\u5206\u6790\u65b0\u589e\u201cpeak\u6ce8\u91ca\u589e\u5f3a\u201d\u6a21\u5757\uff0c\u6574\u5408\u8c03\u63a7\u533a\u57df\u4fe1\u606f3. count\u6d41\u7a0b\u5185\u5b58\u5360\u7528\u964d\u4f4e20%4. \u4f18\u5316TCRBCR\u4f53\u7ec6\u80de\u7a81\u53d8\u68c0\u6d4b\uff0c\u63d0\u5347TIL\u514b\u9686\u5206\u6790\u51c6\u786e\u6027 1. \u652f\u63012023-B\u7248\u53c2\u8003\u57fa\u56e0\u7ec4\uff08\u66f4\u65b0HLA\u53ca\u5c0f\u9f20\u514d\u75ab\u57fa\u56e0\u6ce8\u91ca\uff092. \u517c\u5bb93' v3.1\u30015' v2\u3001VDJ v1.1\u7b49\u6587\u5e933. \u7cfb\u7edf\u8981\u6c42\uff1aPython 3.9+\uff0c\u652f\u6301CentOS 7/8\u3001Ubuntu 18.04/20.044. \u652f\u6301NovaSeq 6000\u6570\u636e v7.0.0 2023-06 1. \u652f\u6301NextSeq X Plus\u9ad8\u4ea7\u51fa\u6570\u636e\uff08\u5355\u6837\u672c\u8fbe100Gb\uff092. \u65b0\u589e\u201c\u6279\u6b21\u6548\u5e94\u53ef\u89c6\u5316\u201d\u6a21\u57573. \u4f18\u5316CRISPR guide\u6bd4\u5bf9\u6548\u7387\uff0c\u51cf\u5c11\u8131\u9776\u8bef\u52244. \u7b80\u5316\u591a\u6837\u672c\u6574\u5408\u6d41\u7a0b\uff0caggr\u547d\u4ee4\u81ea\u52a8\u8bfb\u53d6\u591acount\u7ed3\u679c 1. \u652f\u6301GemCode HT\u6587\u5e93\uff0c\u9002\u914d\u6700\u9ad8100k\u7ec6\u80de\u6837\u672c2. \u5f03\u7528Python 3.7\uff0c\u8981\u6c42Python 3.8+3. \u5185\u5b58\u8981\u6c42\uff1a\u226516GB\uff0810k\u7ec6\u80de\uff09\uff0c\u226548GB\uff0850k\u7ec6\u80de\uff094. \u4e0d\u517c\u5bb9v2\u7cfb\u5217\u65e7\u6587\u5e93 <p>\ud83d\udca1 \u8bf4\u660e\uff1a\u8868\u683c\u5185\u5bb9\u57fa\u4e8e10x Genomics\u5b98\u65b9\u53d1\u5e03\u65e5\u5fd7\u6574\u7406\uff0c\u5b9e\u9a8c\u6027\u529f\u80fd\u53ef\u80fd\u540e\u7eed\u8c03\u6574\uff0c\u5b9e\u9645\u4f7f\u7528\u8bf7\u53c2\u8003\u5bf9\u5e94\u7248\u672c\u5b98\u65b9\u6587\u6863\u3002</p> <pre><code>## \u8fd9\u91cc\u4e0b\u8f7d\u7684\u65f6Cell Ranger 10.0.0\u7248\u672c\n# \u547d\u4ee4\u884c\u4f7f\u7528curl\u4e0b\u8f7d\ncurl -o cellranger-10.0.0.tar.gz \"https://cf.10xgenomics.com/releases/cell-exp/cellranger-10.0.0.tar.gz?Expires=1765682198&amp;Key-Pair-Id=APKAI7S6A5RYOXBWRPDA&amp;Signature=SO3tn4o50UYUViprsueJpWGbkOLqzAUxH8X4fbKgtr4LxexzQFLWWc~Og9I3AUpOKrntOLVFd0TTfJ63X5EuM2jl5fwLvMPVDg2Mh4liM0Lp87qzhyY6TsxdJkRs3UuMlelp3rc2ZATBG9O5yfo-Urxgx-dY5jsnpldy0hKg58XGe8-r6CGmOI1CzGAF4qpiCgJOzRbONK7QHDFTYcKey6Xmh7PT~KPRip24kUcKiJyJzyfhGNdfSACJbJgA02kLEBb2EmZasQFvfRoY0NPMFlnVpFkIv7-p73JA~CiYERWT0awbwdkPn7n7eXItlVktXA3Z2QwiT~DJfsc8eKC2rA__\"\n\n# \u547d\u4ee4\u884c\u4f7f\u7528wget\u4e0b\u8f7d\nwget -O cellranger-10.0.0.tar.gz \"https://cf.10xgenomics.com/releases/cell-exp/cellranger-10.0.0.tar.gz?Expires=1765682198&amp;Key-Pair-Id=APKAI7S6A5RYOXBWRPDA&amp;Signature=SO3tn4o50UYUViprsueJpWGbkOLqzAUxH8X4fbKgtr4LxexzQFLWWc~Og9I3AUpOKrntOLVFd0TTfJ63X5EuM2jl5fwLvMPVDg2Mh4liM0Lp87qzhyY6TsxdJkRs3UuMlelp3rc2ZATBG9O5yfo-Urxgx-dY5jsnpldy0hKg58XGe8-r6CGmOI1CzGAF4qpiCgJOzRbONK7QHDFTYcKey6Xmh7PT~KPRip24kUcKiJyJzyfhGNdfSACJbJgA02kLEBb2EmZasQFvfRoY0NPMFlnVpFkIv7-p73JA~CiYERWT0awbwdkPn7n7eXItlVktXA3Z2QwiT~DJfsc8eKC2rA__\"\n\n# \u4e0b\u8f7d\u5b8c\u6210\u540e\u5b89\u88c5cellranger\n# \u89e3\u538b\ntar -xzf cellranger-10.0.0.tar.gz\n# \u5b89\u88c5\ncd cellranger-10.0.0/bin/\n# \u4f7f\u7528echo $0 \u67e5\u770b\u5f53\u524dshell\u7c7b\u578b\n# \u5982\u679c\u670d\u52a1\u5668\u4e2d\u4f7f\u7528\u7684\u662fbash \uff0c\u5219\u6267\u884c\u5982\u4e0b\u547d\u4ee4\necho \"export PATH=$(pwd):$PATH\" &gt;&gt; ~/.bashrc &amp;&amp; source ~/.bashrc \n# \u5982\u679c\u670d\u52a1\u5668\u4e2d\u4f7f\u7528\u7684\u662fzsh\uff0c\u5219\u6267\u884c\u5982\u4e0b\u547d\u4ee4\necho \"export PATH=$(pwd):$PATH\" &gt;&gt; ~/.zshrc &amp;&amp; source ~/.zshrc\n\n# \u9a8c\u8bc1\u5b89\u88c5\u6210\u529f\ncellranger --version\n</code></pre>"},{"location":"scRNA-seq/#13-cellranger-count","title":"1.3 cellranger count\u4f7f\u7528\u7684\u53c2\u8003\u6587\u4ef6\u4e0b\u8f7d","text":"<p>\u76ee\u524dcellranger count\u4f7f\u7528\u7684\u53c2\u6570\u6587\u4ef6\u4e5f\u505a\u4e86\u66f4\u65b0\uff0c\u76ee\u524d\u7684\u7248\u672c\u4e3a:2024-A\uff0c\u5386\u53f2\u7248\u672c\u4e3a\uff1a2020-A\uff08https://www.10xgenomics.com/support/software/cell-ranger/latest/release-notes/cr-reference-release-notes#2020-a\uff09\u3002</p> <p> Human reference (GRCh38) - 2024-A</p> <p><pre><code># wget \u4e0b\u8f7d\nwget \"https://cf.10xgenomics.com/supp/cell-exp/refdata-gex-GRCh38-2024-A.tar.gz\"\n\n# curl \u4e0b\u8f7d\ncurl -O \"https://cf.10xgenomics.com/supp/cell-exp/refdata-gex-GRCh38-2024-A.tar.gz\"\n# \u9009\u62e9\u4e00\u79cd\u4e0b\u8f7d\u65b9\u5f0f\uff0c\u4e0b\u8f7d\u6210\u529f\u540e\u89e3\u538b\u6587\u4ef6\ntar -xzf refdata-gex-GRCh38-2024-A.tar.gz\n</code></pre> \u89e3\u538b\u540e\u7684\u6587\u4ef6\u76ee\u5f55\u4e2d\u5305\u62ec\u5982\u4e0b\u7684\u6587\u4ef6  </p> <ul> <li>Mouse reference (GRCm39) - 2024-A</li> </ul> <pre><code># wget\u4e0b\u8f7d\nwget \"https://cf.10xgenomics.com/supp/cell-exp/refdata-gex-GRCm39-2024-A.tar.gz\"\n\n# curl \u4e0b\u8f7d\ncurl -O \"https://cf.10xgenomics.com/supp/cell-exp/refdata-gex-GRCm39-2024-A.tar.gz\"\n# \u9009\u62e9\u4e00\u79cd\u4e0b\u8f7d\u65b9\u5f0f\uff0c\u4e0b\u8f7d\u6210\u529f\u540e\u89e3\u538b\u6587\u4ef6\ntar -xzf refdata-gex-GRCm39-2024-A.tar.gz\n</code></pre> <ul> <li>Rat reference (mRatBN7.2) - 2024-A</li> </ul> <pre><code># wget\u4e0b\u8f7d\nwget \"https://cf.10xgenomics.com/supp/cell-exp/refdata-gex-mRatBN7-2-2024-A.tar.gz\"\n\n# curl\u4e0b\u8f7d\ncurl -O \"https://cf.10xgenomics.com/supp/cell-exp/refdata-gex-mRatBN7-2-2024-A.tar.gz\"\n# \u9009\u62e9\u4e00\u79cd\u4e0b\u8f7d\u65b9\u5f0f\uff0c\u4e0b\u8f7d\u6210\u529f\u540e\u89e3\u538b\u6587\u4ef6\ntar -xzf refdata-gex-mRatBN7-2-2024-A.tar.gz\n</code></pre>"},{"location":"scRNA-seq/#14-cellranger-count","title":"1.4 cellranger count\u4f7f\u7528","text":"<p> \u8fd9\u91cc\u4f7f\u7528cellranger\u5b98\u65b9\u63d0\u4f9b\u7684\u793a\u4f8b\u6570\u636e\uff0c\u6570\u636e\u4e0b\u8f7d\u5730\u5740https://www.10xgenomics.com/support/software/cell-ranger/8.0/tutorials/cr-tutorial-ct <pre><code>mkdir run_cellranger_count &amp;&amp; cd run_cellranger_count\nwget https://cf.10xgenomics.com/samples/cell-exp/3.0.0/pbmc_1k_v3/pbmc_1k_v3_fastqs.tar\n# \u89e3\u5305\ntar -xvf pbmc_1k_v3_fastqs.tar\n\n# \u89e3\u5305\u540e\u7684\u6570\u636e\u683c\u5f0f\n#pbmc_1k_v3_fastqs/\n#pbmc_1k_v3_fastqs/pbmc_1k_v3_S1_L001_R2_001.fastq.gz\n#pbmc_1k_v3_fastqs/pbmc_1k_v3_S1_L002_I1_001.fastq.gz\n#pbmc_1k_v3_fastqs/pbmc_1k_v3_S1_L001_R1_001.fastq.gz\n#pbmc_1k_v3_fastqs/pbmc_1k_v3_S1_L002_R1_001.fastq.gz\n#pbmc_1k_v3_fastqs/pbmc_1k_v3_S1_L002_R2_001.fastq.gz\n#pbmc_1k_v3_fastqs/pbmc_1k_v3_S1_L001_I1_001.fastq.gz\n</code></pre> celkanger count\u5728\u4f7f\u7528\u7684\u65f6\u5019\u9700\u8981\u63d0\u524d\u5bf9fastq\u6570\u636e\u8fdb\u884c\u547d\u540d\uff0c\u547d\u540d\u7684\u683c\u5f0f\u5fc5\u987b\u5b98\u65b9\u7ed9\u7684\u683c\u5f0f\uff0c\u5426\u5219\u4f1a\u62a5\u9519\u3002 [\u6837\u672c\u540d]_S[\u6837\u672c\u7f16\u53f7]_L[\u6cf3\u9053\u53f7]_R[\u8bfb\u6bb5\u7c7b\u578b]_001.fastq.gz\uff0c\u4f8b\u5982\uff1aSample_S1_L00X_R1_001.fastq.gz\uff0c Lane 1: L001 and Lane 2: L002.</p> \u5b57\u6bb5 \u8bf4\u660e \u793a\u4f8b <code>[\u6837\u672c\u540d]</code> \u81ea\u5b9a\u4e49\u6837\u672c\u6807\u8bc6\uff08\u5982 sample1\u3001PBMC_001\uff09\uff0c\u9700\u552f\u4e00\u4e14\u4e0d\u542b\u7279\u6b8a\u5b57\u7b26 <code>PBMC_10k</code> <code>S[\u6837\u672c\u7f16\u53f7]</code> \u6837\u672c\u5728\u6d4b\u5e8f\u6279\u6b21\u4e2d\u7684\u7f16\u53f7\uff08\u6570\u5b57\uff0c\u5982 S1\u3001S2\uff09\uff0c\u53ef\u7701\u7565\u4f46\u5efa\u8bae\u4fdd\u7559 <code>S1</code> <code>L[\u6cf3\u9053\u53f7]</code> \u6d4b\u5e8f\u4eea\u7684\u6cf3\u9053\u53f7\uff08\u6570\u5b57\uff0c\u5982 L001\u3001L002\uff09\uff0c\u591a\u6cf3\u9053\u6570\u636e\u9700\u533a\u5206 <code>L001</code> <code>R[\u8bfb\u6bb5\u7c7b\u578b]</code> \u5173\u952e\uff01\u533a\u5206\u4e0d\u540c\u8bfb\u6bb5\uff1aR1\uff1a\u6837\u672c\u7d22\u5f15/\u6761\u7801\u8bfb\u6bb5\uff08\u901a\u5e38 8/10bp\uff09R2\uff1a\u57fa\u56e0\u8868\u8fbe\u8bfb\u6bb5\uff08\u901a\u5e38 98bp\uff09 <code>R1</code> / <code>R2</code> <code>001</code> \u56fa\u5b9a\u540e\u7f00\uff08Illumina \u6807\u51c6\uff0c\u4ee3\u8868\u6d4b\u5e8f\u5faa\u73af\u7f16\u53f7\uff09\uff0c\u4e0d\u53ef\u4fee\u6539 <code>001</code> <p>cellranger count\u5e38\u7528\u53c2\u6570\uff1a</p> \u53c2\u6570 \u7b80\u5199\u793a\u4f8b \u4f5c\u7528 <code>--id</code> <code>--id=pbmc1k</code> \u8f93\u51fa\u6587\u4ef6\u5939\u540d\uff08\u5fc5\u586b\uff09 <code>--transcriptome</code> <code>--trans=/ref/GRCh38</code> \u53c2\u8003\u7d22\u5f15\u8def\u5f84\uff08\u5fc5\u586b\uff09 <code>--fastqs</code> <code>--fastqs=./fastq</code> fastq \u6240\u5728\u76ee\u5f55\uff08\u5fc5\u586b\uff09 <code>--sample</code> <code>--sample=pbmc1k</code> \u6587\u4ef6\u524d\u7f00\uff0c\u591a lane/\u591a Index \u65f6\u5fc5\u586b <code>--expect-cells</code> <code>--expect-cells=3000</code> \u9884\u671f\u7ec6\u80de\u6570\uff0c\u63d0\u9ad8 calling \u7cbe\u5ea6 <code>--force-cells</code> <code>--force-cells=3500</code> \u5f3a\u5236\u7ec6\u80de\u6570\uff0c\u8df3\u8fc7\u81ea\u52a8 calling <code>--include-introns</code> \u5f00\u5173 snRNA-seq \u6838\u5185\u4fe1\u53f7\u9700\u6253\u5f00 <code>--localcores</code> <code>--localcores=16</code> \u6700\u5927 CPU \u6570 <code>--localmem</code> <code>--localmem=64</code> \u6700\u5927\u5185\u5b58 (GB) <p><pre><code># \u4f7f\u7528cellranger count\u8fdb\u884c\u5b9a\u91cf\ncellranger count \\\n  --id=run_count_1kpbmcs \\\n  --fastqs=pbmc_1k_v3_fastqs \\\n  --sample=pbmc_1k_v3 \\\n  --transcriptome=refdata-gex-GRCh38-2020-A \\\n  --create-bam=true \\\n  --localcores=16 \\\n  --localmem=64\n</code></pre> \u8fd0\u884c\u5b8c\u6210\u540e\u8f93\u51fa\u7684\u7ed3\u679c\u8bb2\u89e3\u3002 <pre><code>\u251c\u2500\u2500 analysis   # Cell Ranger \u81ea\u52a8\u8dd1\u7684 PCA\u3001t-SNE\u3001\u805a\u7c7b\u3001\u5dee\u5f02\u57fa\u56e0\n\u251c\u2500\u2500 cloupe.cloupe # \u7528 **Loupe Browser** \u70b9\u9009\u5f0f\u770b\u7ec6\u80de\u5206\u7fa4\u3001\u57fa\u56e0\u8868\u8fbe\u3001\u5dee\u5f02\u57fa\u56e0\u7684\u6587\u4ef6\n\u251c\u2500\u2500 filtered_feature_bc_matrix # \u8fd9\u4e2a\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u53ef\u4ee5\u7528\u4e8e\u4e0b\u6e38Seurat\u6216Scanpy\u7b49\u8f6f\u4ef6\u4f7f\u7528\n\u251c\u2500\u2500 filtered_feature_bc_matrix.h5 # **HDF5 \u7248**\u8868\u8fbe\u77e9\u9635\uff0c\u6bd4 `mtx` \u8bfb\u53d6\u66f4\u5feb\uff0c\u5360\u7528\u66f4\u5c0f\n\u251c\u2500\u2500 metrics_summary.csv\n\u251c\u2500\u2500 molecule_info.h5  # **UMI \u7ea7\u522b**\u4fe1\u606f\n\u251c\u2500\u2500 possorted_genome_bam.bam # \u6bd4\u5bf9\u7684BAM\u6587\u4ef6\n\u251c\u2500\u2500 possorted_genome_bam.bam.bai # \u6bd4\u5bf9\u7684BAM\u6587\u4ef6\u7684\u7d22\u5f15\u6587\u4ef6\n\u251c\u2500\u2500 raw_feature_bc_matrix # \u672a\u8fc7\u6ee4\u7a7a\u6db2\u6ef4\u7b49\u6307\u6807\u7684\u6587\u4ef6\n\u251c\u2500\u2500 raw_feature_bc_matrix.h5\n\u2514\u2500\u2500 web_summary.html # web\u62a5\u544a\u6587\u4ef6\n</code></pre></p>"},{"location":"scRNA-seq/#2","title":"2 \u6570\u636e\u683c\u5f0f\u8f6c\u6362","text":""},{"location":"scRNA-seq/#21-seurat","title":"2.1 \u4e0d\u540c\u683c\u5f0f\u6570\u636e\u751f\u6210Seurat\u5bf9\u8c61\u6570\u636e","text":""},{"location":"scRNA-seq/#22-anndata","title":"2.2 \u4e0d\u540c\u683c\u5f0f\u6570\u636e\u751f\u6210Anndata\u5bf9\u8c61\u6570\u636e","text":""},{"location":"scRNA-seq/#3","title":"3 \u53bb\u6279\u6b21\u805a\u7c7b\u5206\u7fa4","text":"<p>\u597d\u7684\uff0c\u6839\u636e\u60a8\u7684\u8981\u6c42\uff0c\u6211\u5df2\u5c06\u8fd9\u4e9b\u5355\u7ec6\u80de\u7b97\u6cd5\u7684\u5bf9\u6bd4\u6574\u7406\u4e3a Markdown \u8868\u683c\u5f62\u5f0f\uff1a</p>"},{"location":"scRNA-seq/#31","title":"3.1 \u5355\u7ec6\u80de\u53bb\u6279\u6b21\u4e0e\u6574\u5408\u7b97\u6cd5\u5bf9\u6bd4\u8868","text":"\u7b97\u6cd5 \u4f18\u52bf \u9002\u7528\u573a\u666f Harmony \u901f\u5ea6\u6781\u5feb\uff0c\u5185\u5b58\u5360\u7528\u4f4e\uff0c\u6548\u679c\u7a33\u5065 \u5927\u591a\u6570\u5e38\u89c4 scRNA-seq \u6574\u5408\u7684\u9996\u9009 Seurat CCA \u51c6\u786e\u5ea6\u9ad8\uff0c\u4e0e Seurat \u751f\u6001\u6df1\u5ea6\u96c6\u6210 \u6279\u6b21\u8f83\u5c11\u3001\u751f\u7269\u5b66\u5dee\u5f02\u8f83\u7ec6\u5fae\u7684\u60c5\u51b5 scVI \u975e\u7ebf\u6027\u5efa\u6a21\u80fd\u529b\u5f3a\uff0c\u652f\u6301\u6d77\u91cf\u6570\u636e \u6570\u5341\u4e07\u7ea7\u4ee5\u4e0a\u7ec6\u80de\u91cf\uff0c\u6216\u590d\u6742\u6279\u6b21\u6548\u5e94 LIGER \u64c5\u957f\u591a\u7ec4\u5b66\u6574\u5408 \u8f6c\u5f55\u7ec4\u4e0e ATAC-seq \u6216\u86cb\u767d\u7ec4\u8054\u7528 BBKNN \u8ba1\u7b97\u5f00\u9500\u6781\u5c0f \u5feb\u901f\u9884\u89c8\u7ed3\u679c\u6216\u6781\u5927\u578b\u56fe\u6784\u5efa"},{"location":"scRNA-seq/#32-harmony","title":"3.2 harmony\u7b97\u6cd5","text":"<p> Harmony \u5e76\u975e\u76f4\u63a5\u4fee\u6539\u539f\u59cb\u7684\u57fa\u56e0\u8868\u8fbe\u77e9\u9635\uff0c\u800c\u662f\u4f5c\u7528\u4e8e\u4f4e\u7ef4\u7a7a\u95f4\uff0c\u5982\u4e3b\u6210\u5206\u5206\u6790\uff08PCA\uff09\u751f\u6210\u7684\u5d4c\u5165\u5750\u6807 \u3002\u8fd9\u79cd\u8bbe\u8ba1\u4e0d\u4ec5\u6781\u5927\u63d0\u9ad8\u4e86\u8ba1\u7b97\u6548\u7387\uff0c\u8fd8\u907f\u514d\u4e86\u7531\u4e8e\u76f4\u63a5\u4fee\u6539\u8ba1\u6570\u6570\u636e\u800c\u53ef\u80fd\u5f15\u5165\u7684\u5206\u5e03\u626d\u66f2 \u3002Harmony \u7684\u6838\u5fc3\u903b\u8f91\u662f\u4e00\u4e2a\u8fed\u4ee3\u8fc7\u7a0b\uff0c\u4e3b\u8981\u5305\u62ec\u56db\u4e2a\u5173\u952e\u6b65\u9aa4\uff1a\u8f6f\u805a\u7c7b\uff08Soft Clustering\uff09\u3001\u8ba1\u7b97\u5168\u5c40\u4e0e\u6279\u6b21\u8d28\u5fc3\u3001\u5b66\u4e60\u7ebf\u6027\u6821\u6b63\u56e0\u5b50\u4ee5\u53ca\u7ec6\u80de\u7279\u5f02\u6027\u8c03\u6574 \u3002\u8fd9\u4e9b\u6b65\u9aa4\u5171\u540c\u4f5c\u7528\uff0c\u4f7f\u5f97 Harmony \u80fd\u591f\u6709\u6548\u5730\u53bb\u9664\u6279\u6b21\u6548\u5e94\uff0c\u540c\u65f6\u4fdd\u7559\u751f\u7269\u53d8\u5f02\u3002</p> <p>Harmony \u7684\u4e3b\u8981\u4f18\u70b9\u5305\u62ec\uff1a - \u901f\u5ea6\u6781\u5feb\uff1aHarmony \u7684\u8ba1\u7b97\u901f\u5ea6\u975e\u5e38\u5feb\uff0c\u80fd\u591f\u5904\u7406\u6570\u767e\u4e07\u4e2a\u7ec6\u80de\u7684\u6570\u636e\u3002 - \u5185\u5b58\u5360\u7528\u4f4e\uff1aHarmony \u7684\u5185\u5b58\u5360\u7528\u76f8\u5bf9\u8f83\u4f4e\uff0c\u9002\u5408\u5728\u5185\u5b58\u6709\u9650\u7684\u8ba1\u7b97\u73af\u5883\u4e2d\u8fd0\u884c\u3002 $$min_{R,Y} \\sum_{i,k} R_{ki} ||Z_i - Y_k||^2 + \\sigma R_{ki} \\log R_{ki} + \\sigma \\theta R_{ki} \\log\\left(\\frac{O_{ki}}{E_{ki}}\\right)\\phi_i$$ \u5728\u8fd9\u4e00\u516c\u5f0f\u4e2d\uff0c$Z_i$ \u662f\u7ec6\u80de\u7684\u7279\u5f81\u5411\u91cf\uff0c$Y_k$ \u662f\u7c07\u8d28\u5fc3\uff0c$\\sigma$ \u63a7\u5236\u805a\u7c7b\u7684\u201c\u5e73\u6ed1\u5ea6\u201d\uff0c\u800c $\\theta$ \u662f\u5173\u952e\u7684\u591a\u6837\u6027\u60e9\u7f5a\u53c2\u6570 1\u3002$O_{ki}$ \u4ee3\u8868\u7ec6\u80de\u5728\u7c07\u548c\u6279\u6b21\u4e2d\u7684\u89c2\u5bdf\u5171\u73b0\u9891\u7387\uff0c\u800c $E_{ki}$ \u4ee3\u8868\u72ec\u7acb\u6027\u5047\u8bbe\u4e0b\u7684\u9884\u671f\u9891\u7387 \u3002\u5f53\u67d0\u4e2a\u7c07\u8fc7\u5ea6\u7531\u5355\u4e00\u6279\u6b21\u7684\u7ec6\u80de\u5360\u636e\u65f6\uff0c\u60e9\u7f5a\u9879\u4f1a\u663e\u8457\u589e\u52a0\uff0c\u4ece\u800c\u8feb\u4f7f\u7b97\u6cd5\u5bfb\u627e\u80fd\u591f\u6574\u5408\u591a\u4e2a\u6570\u636e\u96c6\u7684\u7279\u5f81\u7ec4\u5408 \u3002</p> <p>\u4e3a\u4e86\u9632\u6b62\u8fc7\u5ea6\u6821\u6b63\uff08Overcorrection\uff09\uff0cHarmony \u91c7\u7528\u4e86\u5cad\u56de\u5f52\uff08Ridge Regression\uff09\u60e9\u7f5a\u9879 $\\lambda$ \u3002$\\lambda$ \u7684\u5b58\u5728\u786e\u4fdd\u4e86\u6821\u6b63\u56e0\u5b50\u7684\u4f30\u8ba1\u662f\u7a33\u5065\u7684\uff0c\u7279\u522b\u662f\u5728\u67d0\u4e9b\u6279\u6b21\u4e2d\u7ec6\u80de\u6570\u91cf\u6781\u5c11\u7684\u60c5\u51b5\u4e0b 16\u3002\u6bcf\u4e2a\u7ec6\u80de\u6700\u7ec8\u63a5\u6536\u5230\u7684\u6821\u6b63\u91cf\u662f\u5176\u6240\u5c5e\u6240\u6709\u7c07\u6821\u6b63\u5411\u91cf\u7684\u52a0\u6743\u5e73\u5747\u503c \u3002Harmony \u91c7\u7528\u7ebf\u6027\u6a21\u578b\uff0c\u4f18\u70b9\u662f\u89e3\u91ca\u6027\u5f3a\u3001\u8ba1\u7b97\u6781\u5176\u5feb\u901f\u3001\u4e14\u4e0d\u5bb9\u6613\u4ea7\u751f\u865a\u5047\u7684\u8fc7\u62df\u5408\uff1b\u800c scVI \u91c7\u7528\u975e\u7ebf\u6027\u6a21\u578b\uff0c\u80fd\u591f\u5904\u7406\u6781\u5176\u5f3a\u70c8\u7684\u975e\u7ebf\u6027\u6279\u6b21\u6548\u5e94\uff0c\u4f46\u5bf9\u5c0f\u6837\u672c\u6570\u636e\u53ef\u80fd\u8fc7\u4e8e\u654f\u611f \u3002 </p> <p> \u6b65\u9aa4 a\uff1a\u6a21\u7cca\u805a\u7c7b\uff08Soft assign cells to clusters\uff09</p> <p>\u628a\u6240\u6709\u7ec6\u80de\u8f6f\u5206\u914d\u5230\u591a\u4e2a\u805a\u7c7b\u4e2d\uff08\u4e0d\u662f \u201c\u975e\u6b64\u5373\u5f7c\u201d \u7684\u786c\u5206\u914d\uff09\uff0c\u540c\u65f6\u901a\u8fc7\u60e9\u7f5a\u9879\uff0c\u8ba9\u6bcf\u4e2a\u805a\u7c7b\u5185\u5c3d\u53ef\u80fd\u5305\u542b\u4e0d\u540c\u6570\u636e\u96c6\u7684\u7ec6\u80de\uff08\u4fdd\u8bc1\u805a\u7c7b\u7684 \u201c\u8de8\u6279\u6b21\u591a\u6837\u6027\u201d\uff09\u3002 \u56fe a \u4e2d\u80fd\u770b\u5230\uff1a\u4e0d\u540c\u989c\u8272\uff08\u6570\u636e\u96c6\uff09\u7684\u7ec6\u80de\u88ab\u5206\u5230\u4e86\u540c\u4e00\u4e2a\u805a\u7c7b\u91cc\uff08\u6bd4\u5982 Cluster 1 \u5305\u542b\u591a\u79cd\u989c\u8272\uff09\u3002 \u6b65\u9aa4 b\uff1a\u8ba1\u7b97\u805a\u7c7b\u4e2d\u5fc3\uff08Get cluster centroids\uff09</p> <p>\u5bf9\u6bcf\u4e2a\u805a\u7c7b\uff0c\u8ba1\u7b97\u5168\u5c40\u4e2d\u5fc3\uff08\u6574\u4e2a\u805a\u7c7b\u7684\u4e2d\u5fc3\uff09\uff0c\u540c\u65f6\u8ba1\u7b97\u8be5\u805a\u7c7b\u5728\u6bcf\u4e2a\u6570\u636e\u96c6\u4e0b\u7684\u4e2d\u5fc3\uff08\u6279\u6b21\u7279\u5f02\u6027\u4e2d\u5fc3\uff09\u3002 \u56fe b \u4e2d\u80fd\u770b\u5230\uff1a\u6bcf\u4e2a\u805a\u7c7b\uff08\u5982 Cluster 1\uff09\u51fa\u73b0\u4e86 \u201c\u5168\u5c40\u4e2d\u5fc3\u201d \u548c \u201c\u4e0d\u540c\u989c\u8272\u5bf9\u5e94\u7684\u6279\u6b21\u4e2d\u5fc3\u201d\u3002 \u6b65\u9aa4 c\uff1a\u8ba1\u7b97\u6821\u6b63\u56e0\u5b50\uff08Get dataset correction factors\uff09</p> <p>\u5728\u6bcf\u4e2a\u805a\u7c7b\u5185\uff0c\u6839\u636e \u201c\u5168\u5c40\u4e2d\u5fc3\u201d \u548c \u201c\u6279\u6b21\u4e2d\u5fc3\u201d \u7684\u5dee\u5f02\uff0c\u8ba1\u7b97\u6bcf\u4e2a\u6570\u636e\u96c6\u7684\u6821\u6b63\u56e0\u5b50\uff08\u7528\u4e8e\u6d88\u9664\u8be5\u6279\u6b21\u5728\u8fd9\u4e2a\u805a\u7c7b\u4e2d\u7684\u504f\u79fb\uff09\u3002 \u56fe c \u4e2d\u7bad\u5934\u8868\u793a\uff1a\u4e0d\u540c\u6570\u636e\u96c6\u7684\u7ec6\u80de\u4f1a\u5411\u5168\u5c40\u4e2d\u5fc3\u7684\u65b9\u5411\u88ab\u6821\u6b63\u3002 \u6b65\u9aa4 d\uff1a\u6821\u6b63\u7ec6\u80de\u4f4d\u7f6e\uff08Move cells based on soft cluster membership\uff09</p> <p>\u5229\u7528\u6b65\u9aa4 a \u4e2d\u7ec6\u80de\u7684 \u201c\u8f6f\u805a\u7c7b\u5206\u914d\u6743\u91cd\u201d\uff0c\u5bf9\u6bcf\u4e2a\u7ec6\u80de\u5e94\u7528\u591a\u4e2a\u805a\u7c7b\u6821\u6b63\u56e0\u5b50\u7684\u7ebf\u6027\u7ec4\u5408\uff08\u56e0\u4e3a\u7ec6\u80de\u88ab\u5206\u914d\u5230\u591a\u4e2a\u805a\u7c7b\uff09\uff0c\u6700\u7ec8\u8c03\u6574\u7ec6\u80de\u7684\u4f4d\u7f6e\u3002 \u56fe d \u4e2d\u80fd\u770b\u5230\uff1a\u540c\u4e00\u7ec6\u80de\u7c7b\u578b\uff08\u540c\u5f62\u72b6\uff09\u7684\u4e0d\u540c\u989c\u8272\uff08\u4e0d\u540c\u6570\u636e\u96c6\uff09\u7ec6\u80de\uff0c\u4f4d\u7f6e\u66f4\u805a\u96c6\u4e86\uff08\u6279\u6b21\u6548\u5e94\u88ab\u6821\u6b63\uff09\u3002 \u6838\u5fc3\u903b\u8f91</p> <p>Harmony \u901a\u8fc7 \u201c\u6a21\u7cca\u805a\u7c7b\u2192\u8ba1\u7b97\u4e2d\u5fc3\u2192\u7b97\u6821\u6b63\u56e0\u5b50\u2192\u6821\u6b63\u7ec6\u80de\u201d \u7684\u8fed\u4ee3\uff0c\u9010\u6e10\u524a\u5f31 \u201c\u805a\u7c7b\u5206\u914d\u201d \u4e0e \u201c\u6570\u636e\u96c6\uff08\u6279\u6b21\uff09\u201d \u7684\u5173\u8054\uff0c\u6700\u7ec8\u8ba9\u76f8\u540c\u7ec6\u80de\u7c7b\u578b\uff08\u540c\u5f62\u72b6\uff09\u7684\u7ec6\u80de\uff0c\u4e0d\u7ba1\u6765\u81ea\u54ea\u4e2a\u6570\u636e\u96c6\uff08\u4ec0\u4e48\u989c\u8272\uff09\uff0c\u90fd\u80fd\u805a\u5728\u4e00\u8d77\uff08\u6d88\u9664\u6279\u6b21\u6548\u5e94\uff09\u3002</p>"},{"location":"scRNA-seq/#seurat4harmony","title":"Seurat4\u4e2dharmony\u7684\u7528\u6cd5","text":""},{"location":"scRNA-seq/#_1","title":"\u5176\u4ed6\u5206\u6790","text":""},{"location":"scRNA-seq/#hlaarcashla","title":"\u5355\u7ec6\u80deHLA\u5206\u6790\u4e4barcasHLA","text":""},{"location":"scRNA-seq/#hlaschlacount","title":"\u5355\u7ec6\u80deHLA\u5206\u6790\u4e4bscHLAcount","text":""},{"location":"scRNA-seq/#hlahla-hd","title":"\u5355\u7ec6\u80deHLA\u5206\u6790\u4e4bHLA-HD","text":""}]}